<!-- START: Main Content-->
{% extends 'office_main.html' %}
{% load static %}



  {% block custom_css %}
  <link id="pagestyle" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
  {% endblock custom_css %}

{% block content %}


  <div class="container-fluid my-3 py-3">
    <div class="row mb-5">
      <div class="col-lg-3">
        <div class="card position-sticky top-1">
          <ul class="nav flex-column bg-white border-radius-lg p-3">
           
           
            <li class="nav-item pt-2">
              <a class="nav-link text-body" data-scroll="" href="#features_overview">
                <div class="icon me-2">
                  <svg class="text-dark mb-1" width="16px" height="16px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <title>box-3d-50</title>
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g transform="translate(-2319.000000, -291.000000)" fill="#FFFFFF" fill-rule="nonzero">
                        <g transform="translate(1716.000000, 291.000000)">
                          <g transform="translate(603.000000, 0.000000)">
                            <path class="color-background" d="M22.7597136,19.3090182 L38.8987031,11.2395234 C39.3926816,10.9925342 39.592906,10.3918611 39.3459167,9.89788265 C39.249157,9.70436312 39.0922432,9.5474453 38.8987261,9.45068056 L20.2741875,0.1378125 L20.2741875,0.1378125 C19.905375,-0.04725 19.469625,-0.04725 19.0995,0.1378125 L3.1011696,8.13815822 C2.60720568,8.38517662 2.40701679,8.98586148 2.6540352,9.4798254 C2.75080129,9.67332903 2.90771305,9.83023153 3.10122239,9.9269862 L21.8652864,19.3090182 C22.1468139,19.4497819 22.4781861,19.4497819 22.7597136,19.3090182 Z"></path>
                            <path class="color-background" d="M23.625,22.429159 L23.625,39.8805372 C23.625,40.4328219 24.0727153,40.8805372 24.625,40.8805372 C24.7802551,40.8805372 24.9333778,40.8443874 25.0722402,40.7749511 L41.2741875,32.673375 L41.2741875,32.673375 C41.719125,32.4515625 42,31.9974375 42,31.5 L42,14.241659 C42,13.6893742 41.5522847,13.241659 41,13.241659 C40.8447549,13.241659 40.6916418,13.2778041 40.5527864,13.3472318 L24.1777864,21.5347318 C23.8390024,21.7041238 23.625,22.0503869 23.625,22.429159 Z" opacity="0.7"></path>
                            <path class="color-background" d="M20.4472136,21.5347318 L1.4472136,12.0347318 C0.953235098,11.7877425 0.352562058,11.9879669 0.105572809,12.4819454 C0.0361450918,12.6208008 6.47121774e-16,12.7739139 0,12.929159 L0,30.1875 L0,30.1875 C0,30.6849375 0.280875,31.1390625 0.7258125,31.3621875 L19.5528096,40.7750766 C20.0467945,41.0220531 20.6474623,40.8218132 20.8944388,40.3278283 C20.963859,40.1889789 21,40.0358742 21,39.8806379 L21,22.429159 C21,22.0503869 20.7859976,21.7041238 20.4472136,21.5347318 Z" opacity="0.7"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </svg>
                </div>
                <span class="text-sm">Features Overview</span>
              </a>
            </li>
            <li class="nav-item pt-2">
              <a class="nav-link text-body" data-scroll="" href="#2fa">
                <div class="icon me-2">
                  <svg class="text-dark mb-1" width="16px" height="16px" viewBox="0 0 40 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <title>switches</title>
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g transform="translate(-1870.000000, -440.000000)" fill="#FFFFFF" fill-rule="nonzero">
                        <g transform="translate(1716.000000, 291.000000)">
                          <g transform="translate(154.000000, 149.000000)">
                            <path class="color-background" d="M10,20 L30,20 C35.4545455,20 40,15.4545455 40,10 C40,4.54545455 35.4545455,0 30,0 L10,0 C4.54545455,0 0,4.54545455 0,10 C0,15.4545455 4.54545455,20 10,20 Z M10,3.63636364 C13.4545455,3.63636364 16.3636364,6.54545455 16.3636364,10 C16.3636364,13.4545455 13.4545455,16.3636364 10,16.3636364 C6.54545455,16.3636364 3.63636364,13.4545455 3.63636364,10 C3.63636364,6.54545455 6.54545455,3.63636364 10,3.63636364 Z" opacity="0.6"></path>
                            <path class="color-background" d="M30,23.6363636 L10,23.6363636 C4.54545455,23.6363636 0,28.1818182 0,33.6363636 C0,39.0909091 4.54545455,43.6363636 10,43.6363636 L30,43.6363636 C35.4545455,43.6363636 40,39.0909091 40,33.6363636 C40,28.1818182 35.4545455,23.6363636 30,23.6363636 Z M30,40 C26.5454545,40 23.6363636,37.0909091 23.6363636,33.6363636 C23.6363636,30.1818182 26.5454545,27.2727273 30,27.2727273 C33.4545455,27.2727273 36.3636364,30.1818182 36.3636364,33.6363636 C36.3636364,37.0909091 33.4545455,40 30,40 Z"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </svg>
                </div>
                <span class="text-sm">Predictions</span>
              </a>
            </li>
            <li class="nav-item pt-2">
              <a class="nav-link text-body" data-scroll="" href="#accounts">
                <div class="icon me-2">
                  <svg class="text-dark mb-1" width="16px" height="16px" viewBox="0 0 42 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <title>time-alarm</title>
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g transform="translate(-2319.000000, -440.000000)" fill="#923DFA" fill-rule="nonzero">
                        <g transform="translate(1716.000000, 291.000000)">
                          <g transform="translate(603.000000, 149.000000)">
                            <path class="color-background" d="M18.8086957,4.70034783 C15.3814926,0.343541521 9.0713063,-0.410050841 4.7145,3.01715217 C0.357693695,6.44435519 -0.395898667,12.7545415 3.03130435,17.1113478 C5.53738466,10.3360568 11.6337901,5.54042955 18.8086957,4.70034783 L18.8086957,4.70034783 Z" opacity="0.6"></path>
                            <path class="color-background" d="M38.9686957,17.1113478 C42.3958987,12.7545415 41.6423063,6.44435519 37.2855,3.01715217 C32.9286937,-0.410050841 26.6185074,0.343541521 23.1913043,4.70034783 C30.3662099,5.54042955 36.4626153,10.3360568 38.9686957,17.1113478 Z" opacity="0.6"></path>
                            <path class="color-background" d="M34.3815652,34.7668696 C40.2057958,27.7073059 39.5440671,17.3375603 32.869743,11.0755718 C26.1954189,4.81358341 15.8045811,4.81358341 9.13025701,11.0755718 C2.45593289,17.3375603 1.79420418,27.7073059 7.61843478,34.7668696 L3.9753913,40.0506522 C3.58549114,40.5871271 3.51710058,41.2928217 3.79673036,41.8941824 C4.07636014,42.4955431 4.66004722,42.8980248 5.32153275,42.9456105 C5.98301828,42.9931963 6.61830436,42.6784048 6.98113043,42.1232609 L10.2744783,37.3434783 C16.5555112,42.3298213 25.4444888,42.3298213 31.7255217,37.3434783 L35.0188696,42.1196087 C35.6014207,42.9211577 36.7169135,43.1118605 37.53266,42.5493622 C38.3484064,41.9868639 38.5667083,40.8764423 38.0246087,40.047 L34.3815652,34.7668696 Z M30.1304348,25.5652174 L21,25.5652174 C20.49574,25.5652174 20.0869565,25.1564339 20.0869565,24.6521739 L20.0869565,15.5217391 C20.0869565,15.0174791 20.49574,14.6086957 21,14.6086957 C21.50426,14.6086957 21.9130435,15.0174791 21.9130435,15.5217391 L21.9130435,23.7391304 L30.1304348,23.7391304 C30.6346948,23.7391304 31.0434783,24.1479139 31.0434783,24.6521739 C31.0434783,25.1564339 30.6346948,25.5652174 30.1304348,25.5652174 Z"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </svg>
                </div>
                <span class="text-sm">Accounts</span>
              </a>
            </li>
            <li class="nav-item pt-2">
              <a class="nav-link text-body" data-scroll="" href="#notifications">
                <div class="icon me-2">
                  <svg class="text-dark mb-1" width="16px" height="16px" viewBox="0 0 44 43" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <title>megaphone</title>
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g transform="translate(-2168.000000, -591.000000)" fill="#FFFFFF" fill-rule="nonzero">
                        <g transform="translate(1716.000000, 291.000000)">
                          <g transform="translate(452.000000, 300.000000)">
                            <path class="color-background" d="M35.7958333,0.273166667 C35.2558424,-0.0603712374 34.5817509,-0.0908856664 34.0138333,0.1925 L19.734,7.33333333 L9.16666667,7.33333333 C4.10405646,7.33333333 0,11.4373898 0,16.5 C0,21.5626102 4.10405646,25.6666667 9.16666667,25.6666667 L19.734,25.6666667 L34.0138333,32.8166667 C34.5837412,33.1014624 35.2606401,33.0699651 35.8016385,32.7334768 C36.3426368,32.3969885 36.6701539,31.8037627 36.6666942,31.1666667 L36.6666942,1.83333333 C36.6666942,1.19744715 36.3370375,0.607006911 35.7958333,0.273166667 Z"></path>
                            <path class="color-background" d="M38.5,11 L38.5,22 C41.5375661,22 44,19.5375661 44,16.5 C44,13.4624339 41.5375661,11 38.5,11 Z" opacity="0.601050967"></path>
                            <path class="color-background" d="M18.5936667,29.3333333 L10.6571667,29.3333333 L14.9361667,39.864 C15.7423448,41.6604248 17.8234451,42.4993948 19.6501416,41.764381 C21.4768381,41.0293672 22.3968823,38.982817 21.7341667,37.1286667 L18.5936667,29.3333333 Z" opacity="0.601050967"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </svg>
                </div>
                <span class="text-sm">Configurations</span>
              </a>
            </li>
            
            
          </ul>
        </div>
      </div>
      <div class="col-lg-9 mt-lg-0 mt-4">
        <!-- Card Change Password -->
        <div class="card mt-4" id="features_overview">
            {% if messages %}
{% for message in messages %}
<div class="alert alert-info alert-dismissible fade show  text-white " role="alert">
    <span class="alert-icon"><i class="ni ni-like-2"></i></span>
    <span class="alert-text"><strong>Info!</strong> Training is running as a background process.. Refresh shortly</span>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">×</span>
    </button>
    </div>
{% endfor %}

{% endif %}
            <div class="card-header d-flex align-items-center border-bottom py-3">
                <div class="d-flex align-items-center">
                 
                  <div class="mx-3">
                    <a href="javascript:;" class="text-dark font-weight-600 text-sm">Features Datatable</a>
                    <small class="d-block text-muted">Train Date: {{train_history.train_date}} | Train Score: {{train_history.train_score}}</small>
                  </div>
                </div>
                <div class="text-end ms-auto">
                  <button type="button" class="btn btn-sm bg-gradient-primary mb-0" data-bs-toggle="modal" data-bs-target="#modal-train">
                    <i class="fas fa-reload pe-2"></i> Train Model
                  </button>
                </div>
              </div>
          <div class="card-body">
          <div class="table-responsive">
            <h6>head()</h6>
            <table class="table table-flush" id="features_head">
              <thead class="thead-light">
                <tr>
                  <th>Date</th>
                  <th>gce_gdp</th>
                  <th>gce_es</th>
                  <th>gedo</th>
                  <th>sdg</th>
                  <th>lg_cex</th>
                </tr>
              </thead>
              <tbody>

                {% for tab in features_head %}
                <tr>
                  <td class="text-sm font-weight-normal">{{ tab.feature_date }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gce_gdp|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gce_es|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gedo|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.sgd|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.lg_cex|floatformat:2 }}</td>
                </tr>
                {% endfor %}
             
               
              </tbody>
            </table>
        </div>
        <h6>tail()</h6>
        <div class="table-responsive">
            <table class="table table-flush" id="features_tail">
              <thead class="thead-light">
                <tr>
                  <th>Date</th>
                  <th>gce_gdp</th>
                  <th>gce_es</th>
                  <th>gedo</th>
                  <th>sdg</th>
                  <th>lg_cex</th>
                </tr>
              </thead>
              <tbody>
                {% for tab in features_tail %}
                <tr>
                  <td class="text-sm font-weight-normal">{{ tab.feature_date }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gce_gdp|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gce_es|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.gedo|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.sgd|floatformat:2 }}</td>
                  <td class="text-sm font-weight-normal">{{ tab.lg_cex|floatformat:2 }}</td>
                </tr>
                {% endfor %}
               
              </tbody>
            </table>
        </div>

    </div>
            
          
        </div>
        <!-- Card Change Password -->
        <div class="card mt-4" id="2fa">
          <div class="card-header d-flex">
            <h5 class="mb-0">Predictions</h5>
            
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <h6>prophet()</h6>
              <table class="table table-flush" id="prophet-data" >
                <thead class="thead-light">
                  <tr>
                    <th>Date</th>
                    <th>yhat</th>
                    <th>yhat_lower</th>
                    <th>yhat_upper</th>

                  </tr>
                </thead>
               
              </table>
            </div>
        </div>
       
        </div>
        <!-- Card Accounts -->
        <div class="card mt-4" id="accounts">
          <div class="card-header">
            <h5>Accounts</h5>
            <p class="text-sm">Here you can setup and manage user accounts.</p>
          </div>
        
        </div>
        <!-- Card Notifications -->
        <div class="card mt-4" id="notifications">
          <div class="card-header">
            <h5>Configurations</h5>
            <p class="text-sm">System Configurations</p>
          </div>
        
        </div>



      </div>
    </div>
   
  </div>

  <div class="modal fade" id="modal-train" tabindex="-1000" role="dialog" aria-labelledby="modal-train" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Model Train Configuration</h5>
            <button type="button" class="btn-close text-dark" data-bs-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            This function will commence the ML training using the Ridge Regression Method.<br />
            We assume that a structured csv called shocks_with_dates.csv exists in the main model <br />
            <a href="{% url 'train' %}" class="btn bg-gradient-secondary" >Click here to start</a>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn bg-gradient-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
  </div>

{% endblock content %}

  {% block custom_js %}
<!-- Kanban scripts -->



  <!-- Kanban scripts -->
  <script src="{% static 'js/plugins/dragula/dragula.min.js' %}"></script>
  <script src="{% static 'js/plugins/jkanban/jkanban.js' %}"></script>
  <script src="{% static 'js/plugins/chartjs.min.js' %}"></script>
  <script src="{% static 'js/plugins/fullcalendar.min.js' %}"></script>
  <script src="{% static 'js/plugins/datatables.js' %}"></script>
  <script src="{% static 'js/plugins/flatpickr.min.js' %}"></script>
  <script src="{% static 'js/plugins/counter.min.js' %}"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
  <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js" ></script>
  <script>
   
    if (document.querySelector('.datepicker')) {
      flatpickr('.datepicker', {
      });
    }
    $('#prophet-data').DataTable({
        serverSide: true,
        ordering:false,
        'ajax': '/office/data?format=datatables',
        'columns': [
            {'data': 'ds'},
            {'data': 'yhat'},
            {'data': 'yhat_lower'},
            {'data': 'yhat_upper'},
        ]
        
      });
  </script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
  {% endblock custom_js %}